### Random Seed Cracking 

![[Pasted image 20211212053132.png]]

There's a registration and Login section for the website.

![[Pasted image 20211212053239.png]]
Registered an account and got a password and example of verify link.

```php
<?php

function genpassverify($length = 10) {

$verify_code = mt_rand(1000000000,9999999999);

mt_srand($verify_code);

$acc_passwd = mt_rand();

return $acc_passwd.':'.$verify_code;

}

?>
```

Looking at the "bak" file given from the url, we know that the password is generated by usning verify code as a seed.

[php_mt_seed](https://github.com/openwall/php_mt_seed)

So I found a PHP mt_rand() seed cracker from open wall which is written in c.

> Git clone the repo and run make. 

```bash
Pattern: EXACT

Version: 3.0.7 to 5.2.0

Found 0, trying 0xfc000000 - 0xffffffff, speed 28185.7 Mseeds/s

Version: 5.2.1+

Found 0, trying 0x3e000000 - 0x3fffffff, speed 226.6 Mseeds/s

seed = 0x3e490984 = 1044973956 (PHP 5.2.1 to 7.0.x; HHVM)

Found 1, trying 0x5a000000 - 0x5bffffff, speed 227.7 Mseeds/s

seed = 0x5b5142bb = 1532052155 (PHP 5.2.1 to 7.0.x; HHVM)

seed = 0x5b5142bb = 1532052155 (PHP 7.1.0+)

Found 3, trying 0xc4000000 - 0xc5ffffff, speed 227.6 Mseeds/s

seed = 0xc4c66cc1 = 3301338305 (PHP 5.2.1 to 7.0.x; HHVM)

seed = 0xc4c66cc1 = 3301338305 (PHP 7.1.0+)

Found 5, trying 0xfe000000 - 0xffffffff, speed 228.1 Mseeds/s

Found 5
```

Putting the password as an input, we got few possibilities.  

![[Pasted image 20211212053642.png]]
The seed is 1532052155 and put this in the url.

![[Pasted image 20211212053702.png]]
Flag is obtained !

